<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perpustakaan Sekolah</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- LOGIN PAGE -->
  <section id="login-page" class="active">
    <div class="login-container card">
      <h2>Login Perpustakaan</h2>
      <form id="login-form">
        <input type="text" id="username" placeholder="Username" required>
        <input type="password" id="password" placeholder="Password" required>
        <button type="button" id="login-btn">Masuk</button>
      </form>
      <p class="hint">ðŸ’¡ Coba login sebagai:
        <br>Admin â†’ <b>admin / admin123</b>
        <br>Pengunjung â†’ <b>user / user123</b>
      </p>
    </div>
  </section>

  <!-- LANDING PAGE -->
  <section id="landing-page">
    <nav class="navbar">
      <h1>ðŸ“š Perpustakaan Sekolah</h1>
      <div id="menu-container">
        <button id="nav-landing">Beranda</button>
        <button id="nav-table">Daftar Buku</button>
        <button id="nav-form">Peminjaman</button>
        <button id="logout-btn">Logout</button>
      </div>
    </nav>

    <div class="hero">
      <h2>Selamat Datang di Dunia Pengetahuan!</h2>
      <p>Temukan buku favoritmu dan tingkatkan wawasanmu bersama kami.</p>
      <button id="to-table">Lihat Koleksi Buku</button>
    </div>
  </section>

  <!-- TABLE PAGE -->
  <section id="table-page">
    <nav class="navbar">
      <h1>ðŸ“˜ Daftar Buku</h1>
      <div>
        <button id="nav-back1">Beranda</button>
        <button id="nav-form2">Peminjaman</button>
        <button id="logout-btn2">Logout</button>
      </div>
    </nav>

    <div class="content card">
      <div id="admin-section">
        <h3>Tambah Buku Baru</h3>
        <form id="addBookForm">
          <input type="text" id="judulBaru" placeholder="Judul Buku" required>
          <input type="text" id="penulisBaru" placeholder="Penulis" required>
          <input type="number" id="tahunBaru" placeholder="Tahun" required>
          <button type="submit">Tambah Buku</button>
        </form>
      </div>

      <input type="text" id="searchBook" placeholder="Cari judul buku...">
      <table>
        <thead>
          <tr>
            <th>No</th>
            <th>Judul Buku</th>
            <th>Penulis</th>
            <th>Tahun</th>
          </tr>
        </thead>
        <tbody id="bookTable"></tbody>
      </table>
    </div>
  </section>

  <!-- FORM PAGE -->
  <section id="form-page">
    <nav class="navbar">
      <h1>ðŸ“– Form Peminjaman Buku</h1>
      <div>
        <button id="nav-back2">Beranda</button>
        <button id="nav-table2">Daftar Buku</button>
        <button id="logout-btn3">Logout</button>
      </div>
    </nav>

    <div class="content card">
      <form id="borrow-form">
        <label>Nama Peminjam:</label>
        <input type="text" id="nama" placeholder="Masukkan nama Anda" required>

        <label>Judul Buku:</label>
        <select id="judulSelect" required>
          <option value="">-- Pilih Buku --</option>
        </select>

        <label>Tanggal Peminjaman:</label>
        <input type="date" id="tanggal" required>
        <button type="submit">Kirim</button>
      </form>

      <p id="notif" class="notif"></p>
    </div>
  </section>

  <script>
    // Data awal
    let daftarBuku = [
      {judul: "Laskar Pelangi", penulis: "Andrea Hirata", tahun: 2005},
      {judul: "Bumi Manusia", penulis: "Pramoedya A. Toer", tahun: 1980},
      {judul: "Negeri 5 Menara", penulis: "Ahmad Fuadi", tahun: 2009},
      {judul: "Ayat-Ayat Cinta", penulis: "Habiburrahman El Shirazy", tahun: 2004},
      {judul: "Dilan 1990", penulis: "Pidi Baiq", tahun: 2014}
    ];

    // Variabel status login
    let role = ""; // admin / user

    const pages = {
      login: document.getElementById('login-page'),
      landing: document.getElementById('landing-page'),
      table: document.getElementById('table-page'),
      form: document.getElementById('form-page')
    };

    function show(page) {
      Object.values(pages).forEach(p => p.classList.remove('active'));
      pages[page].classList.add('active');
      if (page === 'table') renderTable();
      if (page === 'form') updateSelectOptions();
    }

    // LOGIN LOGIC
    document.getElementById('login-btn').onclick = function() {
      const user = document.getElementById('username').value;
      const pass = document.getElementById('password').value;

      if (user === "admin" && pass === "admin123") {
        role = "admin";
        show('landing');
        alert("Selamat datang Admin!");
      } else if (user === "user" && pass === "user123") {
        role = "user";
        show('landing');
        alert("Selamat datang Pengunjung!");
      } else {
        alert("Username atau password salah!");
      }
    };

    // Logout
    document.querySelectorAll('#logout-btn, #logout-btn2, #logout-btn3').forEach(btn => {
      btn.onclick = () => {
        role = "";
        show('login');
      };
    });

    // Navigasi
    document.getElementById('to-table').onclick = () => show('table');
    document.getElementById('nav-table').onclick = () => show('table');
    document.getElementById('nav-form').onclick = () => show('form');
    document.getElementById('nav-landing').onclick = () => show('landing');
    document.getElementById('nav-back1').onclick = () => show('landing');
    document.getElementById('nav-form2').onclick = () => show('form');
    document.getElementById('nav-back2').onclick = () => show('landing');
    document.getElementById('nav-table2').onclick = () => show('table');

    // Render tabel buku
    function renderTable() {
      const tbody = document.getElementById('bookTable');
      const adminSection = document.getElementById('admin-section');
      tbody.innerHTML = '';
      daftarBuku.forEach((buku, i) => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${i+1}</td><td>${buku.judul}</td><td>${buku.penulis}</td><td>${buku.tahun}</td>`;
        tbody.appendChild(tr);
      });

      // Hanya admin bisa tambah buku
      adminSection.style.display = (role === "admin") ? "block" : "none";
    }

    // Update dropdown peminjaman
    function updateSelectOptions() {
      const select = document.getElementById('judulSelect');
      select.innerHTML = '<option value="">-- Pilih Buku --</option>';
      daftarBuku.forEach(buku => {
        const opt = document.createElement('option');
        opt.value = buku.judul;
        opt.textContent = buku.judul;
        select.appendChild(opt);
      });
    }

    // Tambah buku baru
    const addBookForm = document.getElementById('addBookForm');
    addBookForm.addEventListener('submit', function(e) {
      e.preventDefault();
      if (role !== "admin") {
        alert("Hanya admin yang bisa menambah buku!");
        return;
      }
      const judul = document.getElementById('judulBaru').value;
      const penulis = document.getElementById('penulisBaru').value;
      const tahun = document.getElementById('tahunBaru').value;

      daftarBuku.push({judul, penulis, tahun});
      addBookForm.reset();
      renderTable();
      alert("âœ… Buku baru berhasil ditambahkan!");
    });

    // Pencarian buku
    const searchInput = document.getElementById('searchBook');
    searchInput.addEventListener('keyup', function() {
      const filter = searchInput.value.toLowerCase();
      const rows = document.querySelectorAll('#bookTable tr');
      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(filter) ? '' : 'none';
      });
    });

    // Form peminjaman
    const borrowForm = document.getElementById('borrow-form');
    const notif = document.getElementById('notif');
    borrowForm.addEventListener('submit', function(e) {
      e.preventDefault();
      const nama = document.getElementById('nama').value;
      const judul = document.getElementById('judulSelect').value;
      const tanggal = document.getElementById('tanggal').value;

      if (!judul) {
        alert("Silakan pilih buku terlebih dahulu!");
        return;
      }

      notif.textContent = `âœ… ${nama} berhasil meminjam buku "${judul}" pada ${tanggal}`;
      notif.style.display = "block";
      borrowForm.reset();

      setTimeout(() => notif.style.display = "none", 4000);
    });

    // Inisialisasi awal
    renderTable();
    updateSelectOptions();
  </script>
</body>
</html>
